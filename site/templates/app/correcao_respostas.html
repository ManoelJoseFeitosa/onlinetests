{% extends 'app/base.html' %}
{% block title %}Corrigindo: {{ resultado.aluno.nome }}{% endblock %}
{% block content %}
<div class="container mt-4">
    <h1>Corrigindo Avaliação</h1>
    <h4><strong>Aluno:</strong> {{ resultado.aluno.nome }}</h4>
    <h5><strong>Avaliação:</strong> {{ resultado.avaliacao.nome }}</h5>
    <hr>
    <form method="POST">
        {% for resposta in respostas %}
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <strong>Questão:</strong>
                    
                    {% if resposta.questao.imagem_nome %}
                        <div class="my-3 text-center">
                            <img src="{{ url_for('static', filename='uploads/questoes/' + resposta.questao.imagem_nome) }}"
                                 alt="{{ resposta.questao.imagem_alt or 'Imagem da questão' }}"
                                 class="img-fluid rounded border"
                                 style="max-height: 350px;">
                        </div>
                    {% endif %}
                    <span style="white-space: pre-wrap;">{{ resposta.questao.texto | safe }}</span>
                </div>
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">Resposta do Aluno:</h6>
                    <p class="card-text" style="background-color: #fffbe6; border: 1px solid #ffeeba; padding: 1rem; border-radius: .25rem; white-space: pre-wrap;">{{ resposta.resposta_aluno }}</p>
                </div>
                <div class="card-footer">
                    <div class="form-group">
                        <label><strong>Avaliar Resposta:</strong></label>
                        <div class="form-check"><input class="form-check-input" type="radio" name="status_{{ resposta.id }}" value="correta" required><label class="form-check-label text-success">Correta (Nota máxima)</label></div>
                        <div class="form-check"><input class="form-check-input" type="radio" name="status_{{ resposta.id }}" value="parcial"><label class="form-check-label text-warning">Parcialmente Correta (Metade da nota)</label></div>
                        <div class="form-check"><input class="form-check-input" type="radio" name="status_{{ resposta.id }}" value="incorreta"><label class="form-check-label text-danger">Incorreta (Zero)</label></div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="feedback_{{ resposta.id }}"><strong>Feedback (Opcional):</strong></label>
                        <textarea class="form-control" name="feedback_{{ resposta.id }}" id="feedback_{{ resposta.id }}" rows="2"></textarea>
                    </div>
                </div>
            </div>
        {% endfor %}
        <button type="submit" class="btn btn-success btn-lg">Salvar Correção e Finalizar Nota</button>
        <a href="{{ url_for('correcao_lista_alunos', avaliacao_id=resultado.avaliacao_id) }}" class="btn btn-secondary btn-lg">Cancelar</a>
    </form>
</div>
{% endblock %}